# kids-copier
 Copying xml, txt, and generally any text files, structured or not, according to the specified templates

Утилита предназначена для копирования заданного шаблона текстового файла заданное количество раз, с заданными именами файлов.
Утилита может работать с любыми текстовыми файлами структурированными и нет. Пример возможных использований файлов: txt, xml, json, css, html и другие форматы.
Работа осуществляется по файлам *.cliche расположенным в папке IN в корне программы. Саму папку IN можно задать в параметрах запуска приложения с ключом  inFolder. Если папки нет, то она будет создана и будет показано сообщение об этом. Если во входной папке не будут найдены файлы *.cliche, то об этом будет показано соответствующее сообщение.
Папка с результатами автоматически генерируется в корне программы. Путь к папке можно в параметрах запуска приложения с ключом  outFolder. Так же с помощью параметра clearOutFolder можно включить и отключить удаление папки с результатами перед началом работы программы, по умолчанию имеет значение true. Параметр принимает булевские значения.
Перед началом работы каждый файл cliche проходит проверку по схеме. Проверка проходит последовательно, непосредственно перед работой по каждому файлу cliche. В случае ошибки по схеме дальнейшая работа прекращается.

## Структура файла cliche
```xml
<cliche>
	<fileNameMask>TestDocument_${currDate}_${inc}.xml</fileNameMask>
	<amountCopyes>20</amountCopyes>
	<toSubFolder>false</toSubFolder>
	<encoding>UTF-8</encoding>
	<xmlVersion>1.0</xmlVersion>
	<formulas>
		<formula name="inc" formula="inc(0,1)" isLoop="true" isUnique="true"/>
	</formulas>
	<loopTexts>
		<loopText name="text" amountCopyes="100"><![CDATA[ some loop text]]></loopText>
	</loopTexts>
	<mainText>
		<![CDATA[
			body
		]]>
	</mainText>
</cliche>
```
* В параметре fileNameMask задается формат имени генерируемого файла. Важно! При использовании для более чем одной копии необходимо использовать какие-либо формулы, позволяющие генерировать уникальные имена файлов, иначе на выходе получится один файл с результатом последнего документа. Параметр обязательный.
* В параметре amountCopyes задается количество копий генерируемого файла. Параметр не обязательный. По умолчанию 10 копий.
* В параметре toSubFolder задается условие при котором сгенерированные файлы будут внутри папки out создаваться в подпапке с именем файла cliche. Параметр обязательный.
* В параметре encoding задается кодировка результирующего файла. Параметр не обязательный. По умолчанию UTF-8.
* В параметре xmlVersion задается версия xml. Параметр не обязательный. По умолчанию пусто. Если параметр указан, то в начале файла будет сгенерирован тэг XML ```xml<?xml version="значение тега xmlVersion" encoding="кодировка из тега encoding"?>```.
* В разделе formulas задаются формулы значений. Каждая формула объявляется в теге formula. Атрибут name задает имя формулы которое можно использовать в имени файла, в разделе повторяющихся фрагментов текста и в главном разделе текста. Имя формулы указывается в фигурных скобках с предварительным указанием знака доллара (${имя формулы}). В атрибуте formula указывается непосредственно формула с соответствующими параметрами. Оба атрибута являются обязательными. Так же есть не обязательный атребут isLoop. Этот атрибут задает условие заполнения если в документе используется одна формула несколько раз. Значение true указывает на, то что для каждого вхождения формулы будет генерироваться новое значение. Значение false говорит, что используется одно значение для каждого документа. По умолчанию значение атрибута isLoop=false. Так же есть не обязательный атребут isUnique. Этот атрибут задает условие уникальности значений в рамках одного клише. Значение true указывает на, то что для каждого вызова формулы будет браться уникальное, ранее не использованное значение. Значение false говорит, что знаения по результатам работы формулы могут повторяться. По умолчанию значение атрибута isUnique=false.Важно! Внутри формулы не могут использоваться значения формул.
* В не обязательном разделе loopTexts задаются повторяющиеся фрагменты текста. Каждый фрагмент объявляется в теге loopText. Атрибут name задает имя формулы которое можно использовать в главном разделе текста. Имя фрагмента используется аналогично имени формулы и не должно совпадать с именами формул. Атрибут является обязательным. * В атрибуте amountCopyes указывается количество копий фрагмента в главном разделе текста. Сам фрагмент указывается в теле тега в разделе CDATA. Важно! Повторяющиеся фрагменты могут использоваться в нескольких местах в главном разделе текста, но не могут использоваться внутри других повторяющихся фрагментов. 
* В теге mainText задается основной текст (главный раздел текста). Задается он в теле тега в разделе CDATA.

## Реализованные на данный момент формулы и их описание:

* ***calcdate(day:1, year:-2, week:4, month:-8, 'yyyy-MM-dd')*** - высчитывает дату от текущей даты. Параметр указывает то что вычисляем (день, год, месяц, неделя) (можеь использоваться только один параметр). Последний параметр - формат вывода даты (не обязательный).
* ***currentdate('yyyy-MM-dd')*** - выводит текущую дату в заданном формате.
* ***inc(0,1)*** - счетчик. 1 параметр задает начальное число, 2 параметр задает шаг приращения. Первое сгенерированное значение будет значение 1 параметра + значение 2 параметра.
* ***incpadleft(0,1,6,'0')*** - аналог inc. 3 параметр задает количество символов. 4 параметр задает символы дополняющие слева генерированное значение для получения длинны указанной в 3 параметре.
* ***ogrnul()*** - генерирует ОГРН с правильным контрольным числом. 1 параметр задает первый символ (кому присвоен регистрационный номер (1, 5 – ЮЛ, 2, 4, 6, 7,8, 9 – гос организации, 3 - ИП)) . 2 параметр задает последние 2 цифры года. 3 параметр  задает регион РФ. Все параметры не обязательны. Дополнительные примеры использования: ogrn('1'), ogrn('1','03'), ogrn('1','03','78').
* ***ogrngos()*** - полный аналог ogrnul для Гос. организаций.
* ***ogrnip()*** - полный аналог ogrnul для ИП.
* ***inn('ul')*** - генерирует ИНН. 1 обязательный параметр задает тип ИНН (ul, fl, inul). 2 параметр задает регион или код налоговой (2 или 4 цифры). Для inul (иностранное ЮЛ) 2 параметр не учитывается. Дополнительные примеры использования: inn('ul','78'), inn('ul','7812'), inn('fl'), inn('fl','78'), inn('fl','7812'), inn('inul').
* ***kpp()*** - генерирует КПП. 1 параметр задает тип ИНН (ul, fl, inul). 2 параметр задает регион или код налоговой (2 или 4 цифры). Все параметры не обязательны.  Дополнительные примеры использования: kpp('ul'), kpp('ul','7812'), kpp('inul').
* ***rschet()*** - генерирует расчетный счет. 1 параметр задает код валюты счета. 2 параметр задает первые 3 цифры счета. 3 параметр задает 4 и 5 цифры счета. 4 параметр задает комбинацию, означающая отделение банка, в котором открыт счёт. 5 параметр задает стартовое значение с которого будут генерироваться значения порядкового номера счёта в банке. Все параметры не обязательны. Дополнительные примеры использования: rschet('810'), rschet('810','103'), rschet('810','103','22'), rschet('810','103','22','2880'), rschet('810','103','22','2880','38').
* ***randomset('fl','7812','random text','16489')*** - выводит случайное значение из перечисленных в параметрах.
* ***faker()*** - будет использована специализированная библиотека faker для генерации случайных или предустановленных значений. В качестве параметров используется путь до конкретной функции библиотеки. Список функций можно посмотреть в описании к библиотеке http://dius.github.io/java-faker/apidocs/index.html . Для функций, возвращающих даты добавлен параметр, задающий формат вывода даты. На текущий момент можно использовать функции без параметров или использующие базовые типы (int, String, Date, boolean), а так же enum.
